<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Centro de Despacho – Cruz Roja Hermosillo</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

<style>
  body { margin:0; padding:0; font-family: 'Segoe UI', Arial, sans-serif; }
  #map { height: 100vh; width: 100vw; background: #e5e3df; } /* Fondo gris por si tarda en cargar */

  /* Panel centrado superior */
  .header-panel {
    position: absolute;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: white;
    padding: 12px 30px;
    border-radius: 50px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    z-index: 1000;
    text-align: center;
    border-top: 5px solid #c40000;
    min-width: 280px;
    pointer-events: none; /* Permite hacer clic a través del panel al mapa */
  }

  .header-panel h3 { margin: 0; color: #c40000; font-size: 1.1rem; }
  .header-panel p { margin: 2px 0 0 0; font-size: 0.85rem; color: #555; }
  .status-dot { height: 10px; width: 10px; background: #2ecc71; border-radius: 50%; display: inline-block; margin-right: 5px; }

  /* Ajuste para que el control de capas se vea bien */
  .leaflet-top.leaflet-right { top: 10px; }
</style>
</head>
<body>

<div class="header-panel">
  <h3>CRUZ ROJA MEXICANA</h3>
  <p><span class="status-dot"></span>Centro de Despacho | Sistema Operativo</p>
</div>

<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
// 1. Inicializar mapa
var map = L.map('map', {
    center: [29.09, -110.96],
    zoom: 13
});

// 2. Capa base obligatoria (OpenStreetMap)
var base = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: '© OpenStreetMap'
}).addTo(map);

// 3. Capas adicionales opcionales
var trafico = L.tileLayer("https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png", { opacity: 0.7 });
var clima = L.tileLayer("https://tile.openweathermap.org/map/precipitation_new/{z}/{x}/{y}.png?appid=b99d75364d37e9fd2bedb86b7e42743e", { opacity: 0.5 });

// 4. Icono personalizado para Hospitales
var hospitalIcon = L.icon({
  iconUrl: "<a href="https://www.flaticon.com/free-icons/hospital" title="hospital icons">Hospital icons created by Freepik - Flaticon</a>",
  iconSize: [35, 35],
  iconAnchor: [17, 35],
  popupAnchor: [0, -30]
});

// 5. Listado de Hospitales
var hospitalesData = [
    ["Hospital General de Especialidades", 29.08149, -111.00376],
    ["IMSS HGZ 14", 29.09878, -111.00153],
    ["IMSS HGZ 02", 29.10370, -110.95337],
    ["IMSS HGZ 15", 29.08649, -110.96219],
    ["Centro Médico del Noroeste", 29.08141, -110.95062],
    ["Hospital CIMA", 29.06470, -110.96136],
    ["Hospital San José", 29.12069, -110.95190],
    ["ISSSTE Dr. Fernando Ocaranza", 29.11015, -110.95071],
    ["SSA Hospital de la Mujer", 29.11594, -110.97256],
    ["Hospital Militar Regional", 29.11487, -110.94862],
    ["ISSSTESON Dr. Ignacio Chavez", 29.09679, -110.95348],
    ["Hospital San Diego de Alcala", 29.08964, -110.95214],
    ["Hospital Licona", 29.08144, -110.94933],
    ["SSA Hospital Infantil", 29.11639, -110.97176]
];

// Crear grupo de marcadores
var layerHospitales = L.layerGroup();
hospitalesData.forEach(function(h) {
  L.marker([h[1], h[2]], {icon: hospitalIcon})
    .bindPopup("<b>" + h[0] + "</b>")
    .addTo(layerHospitales);
});

// Añadir hospitales al inicio
layerHospitales.addTo(map);

// 6. Control de Capas (Interactivo)
var overlayMaps = {
  "Hospitales": layerHospitales,
  "Vista Tráfico": trafico,
  "Precipitación": clima
};

L.control.layers(null, overlayMaps, {collapsed: false}).addTo(map);

</script>
</body>
</html>
