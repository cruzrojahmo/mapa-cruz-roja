<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Centro de Despacho ‚Äì Cruz Roja Hermosillo</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<style>
  body { margin:0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
  #map { height: 100vh; width: 100vw; }

  /* Panel centrado en la parte superior */
  .header-panel {
    position: absolute;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(255, 255, 255, 0.95);
    padding: 10px 25px;
    border-radius: 50px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    z-index: 1000;
    text-align: center;
    border-top: 4px solid #c40000;
    min-width: 300px;
  }

  .header-panel h3 {
    margin: 0;
    color: #c40000;
    font-size: 1.2rem;
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  .header-panel p {
    margin: 2px 0 0 0;
    font-size: 0.9rem;
    color: #333;
    font-weight: bold;
  }

  .status-dot {
    height: 10px;
    width: 10px;
    background-color: #2ecc71;
    border-radius: 50%;
    display: inline-block;
    margin-right: 5px;
  }
</style>
</head>
<body>

<div class="header-panel">
  <h3>Cruz Roja Mexicana</h3>
  <p><span class="status-dot"></span>Centro de Despacho | Sistema Operativo</p>
</div>

<div id="map"></div>

<script>
// ================= CONFIGURACI√ìN DE MAPA =================
var map = L.map('map', {
    center: [29.09, -110.96],
    zoom: 13,
    zoomControl: false // Lo movemos para que no estorbe al panel
});

// Reubicar control de zoom abajo a la izquierda
L.control.zoom({ position: 'bottomleft' }).addTo(map);

// ================= CAPAS BASE =================
var base = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: '¬© OpenStreetMap'
}).addTo(map);

// Capa de Tr√°fico (Vialidades resaltadas)
var trafico = L.tileLayer("https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png", {
  opacity: 0.7,
  attribution: '¬© OpenStreetMap contributors, Tiles style by Humanitarian OpenStreetMap Team'
});

// Capa de Clima (Precipitaci√≥n)
var clima = L.tileLayer("https://tile.openweathermap.org/map/precipitation_new/{z}/{x}/{y}.png?appid=b99d75364d37e9fd2bedb86b7e42743e", {
  opacity: 0.5
});

// ================= ICONO PERSONALIZADO =================
var hospitalIcon = L.icon({
  iconUrl: "<a href="https://www.flaticon.com/free-icons/hospital" title="hospital icons">Hospital icons created by Freepik - Flaticon</a>", // Icono de ubicaci√≥n con cruz m√©dica
  iconSize: [38, 38],
  iconAnchor: [19, 38],
  popupAnchor: [0, -34]
});

// ================= DATOS DE HOSPITALES =================
var hospitalesData = [
    ["Hospital General de Especialidades del Estado de Sonora",29.08149558866,-111.0037625599],
    ["IMSS HGZ 14",29.0987883528,-111.0015381778],
    ["IMSS HGZ 02",29.1037001297,-110.9533747324],
    ["IMSS HGZ 15",29.0864911445,-110.9621912885],
    ["Centro M√©dico del Noroeste",29.0814119646,-110.9506239757],
    ["Hospital CIMA",29.0647069176,-110.9613672007],
    ["Hospital San Jos√©",29.1206929305,-110.9519082812],
    ["ISSSTE Hospital Dr. Fernando Ocaranza",29.1101520739,-110.9507142182],
    ["SSA Hospital Integral de la Mujer",29.115949405330400,-110.97256351082],
    ["Hospital Militar Regional",29.114872225403700,-110.948626122958],
    ["ISSSTESON Hospital Dr. Ignacio Chavez",29.096798578712000,-110.953480785785],
    ["Hospital San Diego de Alcala", 29.08964351884390,-110.952141600676],
    ["Hospital Licona",29.08144383513480,-110.949337764691],
    ["SSA Hospital Infantil del Estado",29.1163953149,-110.9717606065]
];

// Grupo para los marcadores de hospitales
var layerHospitales = L.layerGroup();

hospitalesData.forEach(h => {
  L.marker([h[1], h[2]], {icon: hospitalIcon})
    .bindPopup("<b style='color:#c40000;'>" + h[0] + "</b><br>Unidad M√©dica de Emergencia")
    .addTo(layerHospitales);
});

// Los hospitales aparecen por defecto
layerHospitales.addTo(map);

// ================= CONTROL DE CAPAS =================
// Organizado para que el usuario pueda prender/apagar
var capasSuperpuestas = {
  "üè• Mostrar Hospitales": layerHospitales,
  "üöó Tr√°fico en tiempo real": trafico,
  "üåßÔ∏è Radar de Lluvia": clima
};

L.control.layers(null, capasSuperpuestas, {
  collapsed: false,
  position: 'topright'
}).addTo(map);

</script>
</body>
</html>
