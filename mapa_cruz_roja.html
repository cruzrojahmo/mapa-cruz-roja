<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Centro de Despacho – Cruz Roja Hermosillo</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Leaflet -->
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<style>
body { margin:0; font-family: Arial, sans-serif; }
#map { height: 100vh; }

.panel {
  position: absolute;
  top: 15px;
  right: 15px;
  background: white;
  padding: 15px;
  border-radius: 12px;
  box-shadow: 0 0 15px rgba(0,0,0,0.25);
  z-index: 999;
  width: 240px;
}

.panel h3 {
  margin: 0 0 10px 0;
  color: #c40000;
}
</style>
</head>
<body>

<div id="map"></div>

<div class="panel">
  <h3>Cruz Roja Mexicana</h3>
  Centro de Despacho<br>
  Sistema operativo ✔
</div>

<script>

// ================= MAPA BASE =================
var map = L.map('map').setView([29.09, -110.96], 12);

// OpenStreetMap
var base = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: '© OpenStreetMap'
}).addTo(map);

// ================= ICONO PROFESIONAL =================
var hospitalIcon = L.icon({
  iconUrl: "https://cdn-icons-png.flaticon.com/512/3774/3774299.png",
  iconSize: [32, 32]
});

// ================= HOSPITALES =================
var hospitales = [
["Hospital General de Especialidades del Estado de Sonora",29.08149558866,-111.0037625599],
["IMSS HGZ 14",29.0987883528,-111.0015381778],
["IMSS HGZ 02",29.1037001297,-110.9533747324],
["IMSS HGZ 15",29.0864911445,-110.9621912885],
["Centro Médico del Noroeste",29.0814119646,-110.9506239757],
["Hospital CIMA",29.0647069176,-110.9613672007],
["Hospital San José",29.1206929305,-110.9519082812],
["ISSSTE Hospital Ocaranza",29.1101520739,-110.9507142182],
["Hospital Infantil del Estado",29.1163953149,-110.9717606065]
];

hospitales.forEach(h => {
  L.marker([h[1], h[2]], {icon: hospitalIcon})
    .addTo(map)
    .bindPopup("<b>" + h[0] + "</b>");
});

// ================= CAPA TRÁFICO =================
// (usa mosaico libre tipo tráfico estilo OSM)
var trafico = L.tileLayer(
  "https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png",
  { opacity: 0.6 }
);

// ================= CAPA CLIMA (OpenWeather) =================
// ⚠️ Necesitarás API gratis en:
// https://openweathermap.org/api
var clima = L.tileLayer(
  "https://tile.openweathermap.org/map/precipitation_new/{z}/{x}/{y}.png?appid=TU_API_KEY",
  { opacity: 0.5 }
);

// ================= ZONAS DE RIESGO =================
var zonasRiesgo = L.layerGroup();

var colonias = [
"Villa Verde","Laura Alicia Frías","Las Cuevitas","La Choya","Los Arroyos",
"Solidaridad","4 Olivos","Caridad","Agualurca","Altares",
"Nuevo Hermosillo","Vista Real","Las Minitas","Sahuaro","Arco Iris"
];

// Marcado aproximado en Hermosillo (visual despacho)
colonias.forEach((c, i) => {
  var lat = 29.05 + (Math.random() * 0.1);
  var lng = -111.0 + (Math.random() * 0.1);

  L.circle([lat, lng], {
    color: "red",
    fillColor: "#ff4d4d",
    fillOpacity: 0.35,
    radius: 600
  }).bindPopup("Zona de riesgo:<br><b>" + c + "</b>")
    .addTo(zonasRiesgo);
});

// ================= CONTROL DE CAPAS =================
var capas = {
  "Mapa base": base,
  "Tráfico": trafico,
  "Clima": clima,
  "Zonas de riesgo": zonasRiesgo
};

L.control.layers(null, capas, {collapsed:false}).addTo(map);

</script>
</body>
</html>
